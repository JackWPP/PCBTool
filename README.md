# PCBå·¥å…·åç«¯é¡¹ç›®

ä¸€ä¸ªæ”¯æŒå¤šç”¨æˆ·å¹¶å‘çš„PCBç”µè·¯è®¾è®¡å’Œåˆ†æå·¥å…·çš„åç«¯æœåŠ¡ã€‚åŸºäºFastAPIæ„å»ºï¼Œæ”¯æŒç”¨æˆ·éš”ç¦»ã€ä¼šè¯ç®¡ç†å’Œæµå¼å¤„ç†ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½å¹¶å‘**: æ”¯æŒ5ä¸ªä»¥ä¸Šå¹¶å‘è¯·æ±‚å¤„ç†
- ğŸ‘¥ **ç”¨æˆ·éš”ç¦»**: å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œã€ç™»å½•å’Œæƒé™ç®¡ç†
- ğŸ’¬ **ä¼šè¯ç®¡ç†**: æ¯æ¬¡è¯·æ±‚å°è£…ä¸ºç‹¬ç«‹çš„å¯¹è¯ä¼šè¯
- ğŸ”’ **å®‰å…¨è®¤è¯**: JWTä»¤ç‰Œè®¤è¯å’Œç”¨æˆ·æƒé™æ§åˆ¶
- ğŸ“ **æ–‡ä»¶ç®¡ç†**: å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ å’Œç”¨æˆ·ç›®å½•éš”ç¦»
- ğŸ¤– **AIé©±åŠ¨**: é›†æˆå¤šä¸ªAIæœåŠ¡è¿›è¡Œç”µè·¯åˆ†æ
- ğŸ“Š **æµå¼å“åº”**: å®æ—¶è¿›åº¦åé¦ˆå’Œé•¿æ—¶é—´ä»»åŠ¡å¤„ç†
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**: SQLAlchemy ORMå’Œæ•°æ®åº“ç®¡ç†
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**: Dockerå’ŒDocker Composeæ”¯æŒ

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. å›¾ç‰‡åˆ†ææ¨¡å—
- ä¸Šä¼ PCBç”µè·¯å›¾ç‰‡
- AIé©±åŠ¨çš„ç”µè·¯è¯†åˆ«å’Œåˆ†æ
- ç”ŸæˆBOMæ¸…å•å’Œéœ€æ±‚æ–‡æ¡£

### 2. BOMåˆ†ææ¨¡å—
- å…ƒå™¨ä»¶ä»·æ ¼æŸ¥è¯¢å’Œæ¯”è¾ƒ
- å¤šä¸ªä¾›åº”å•†ç½‘ç«™ä»·æ ¼å¯¹æ¯”
- æ€»æˆæœ¬è®¡ç®—å’Œä¼˜åŒ–å»ºè®®

### 3. ä»£ç ç”Ÿæˆæ¨¡å—
- åŸºäºéœ€æ±‚æ–‡æ¡£ç”Ÿæˆæ§åˆ¶ä»£ç 
- æ”¯æŒArduinoã€Raspberry Piç­‰å¹³å°
- ä»£ç éªŒè¯å’Œæ ¼å¼åŒ–

### 4. éƒ¨ç½²æŒ‡å—æ¨¡å—
- è‡ªåŠ¨ç”Ÿæˆéƒ¨ç½²è¯´æ˜
- æ–‡æœ¬è½¬è¯­éŸ³åŠŸèƒ½
- éƒ¨ç½²æ£€æŸ¥æ¸…å•

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
PCBTool/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py              # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py          # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ conversation.py  # ä¼šè¯æ¨¡å‹
â”‚   â”‚   â””â”€â”€ task.py          # ä»»åŠ¡æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/             # Pydanticæ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ user.py          # ç”¨æˆ·æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ conversation.py  # ä¼šè¯æ¨¡å¼
â”‚   â”‚   â””â”€â”€ task.py          # ä»»åŠ¡æ¨¡å¼
â”‚   â”œâ”€â”€ api/                 # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.py          # è®¤è¯API
â”‚   â”‚   â”œâ”€â”€ conversations.py # ä¼šè¯ç®¡ç†API
â”‚   â”‚   â””â”€â”€ tasks.py         # ä»»åŠ¡ç®¡ç†API
â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ auth_service.py      # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ image_service.py     # å›¾ç‰‡å¤„ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ bom_service.py       # BOMåˆ†ææœåŠ¡
â”‚   â”‚   â”œâ”€â”€ code_service.py      # ä»£ç ç”ŸæˆæœåŠ¡
â”‚   â”‚   â””â”€â”€ deployment_service.py # éƒ¨ç½²æœåŠ¡
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ security.py      # å®‰å…¨å·¥å…·
â”‚   â”‚   â”œâ”€â”€ file_utils.py    # æ–‡ä»¶å·¥å…·
â”‚   â”‚   â””â”€â”€ api_client.py    # APIå®¢æˆ·ç«¯
â”‚   â””â”€â”€ core/                # æ ¸å¿ƒåŠŸèƒ½
â”‚       â”œâ”€â”€ deps.py          # ä¾èµ–æ³¨å…¥
â”‚       â””â”€â”€ exceptions.py    # å¼‚å¸¸å¤„ç†
â”œâ”€â”€ uploads/                 # ç”¨æˆ·æ–‡ä»¶å­˜å‚¨
â”œâ”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml       # Dockerç¼–æ’
â”œâ”€â”€ Dockerfile              # Dockeré•œåƒ
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ .env.example           # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd PCBTool

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘.envæ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„APIå¯†é’¥å’Œæ•°æ®åº“è¿æ¥
```

### 3. å¯åŠ¨æœåŠ¡

#### æ–¹å¼ä¸€ï¼šç›´æ¥å¯åŠ¨
```bash
# Windows
start.bat

# æˆ–è€…æ‰‹åŠ¨å¯åŠ¨
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

#### æ–¹å¼äºŒï¼šDockerå¯åŠ¨
```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

### 4. éªŒè¯å®‰è£…

```bash
# è¿è¡Œå¿«é€Ÿæµ‹è¯•
python quick_test.py

# è¿è¡Œå¹¶å‘æµ‹è¯•
python concurrent_test.py load 5
```

## ğŸ“– APIæ–‡æ¡£

å¯åŠ¨æœåŠ¡åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€æŸ¥çœ‹APIæ–‡æ¡£ï¼š

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **å¥åº·æ£€æŸ¥**: http://localhost:8000/health

## ğŸ”‘ ä¸»è¦APIç«¯ç‚¹

### è®¤è¯ç›¸å…³
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /auth/login` - ç”¨æˆ·ç™»å½•
- `GET /auth/me` - è·å–ç”¨æˆ·ä¿¡æ¯

### ä¼šè¯ç®¡ç†
- `POST /conversations/` - åˆ›å»ºæ–°ä¼šè¯
- `GET /conversations/` - è·å–ä¼šè¯åˆ—è¡¨
- `GET /conversations/{id}` - è·å–ä¼šè¯è¯¦æƒ…
- `POST /conversations/{id}/upload-image` - ä¸Šä¼ å›¾ç‰‡åˆ†æ
- `POST /conversations/{id}/analyze-text` - æ–‡æœ¬åˆ†æ
- `GET /conversations/{id}/results` - è·å–åˆ†æç»“æœ

### ä»»åŠ¡å¤„ç†
- `POST /tasks/conversations/{id}/bom-analysis` - BOMåˆ†æ
- `POST /tasks/conversations/{id}/code-generation` - ä»£ç ç”Ÿæˆ
- `POST /tasks/conversations/{id}/deployment-guide` - ç”Ÿæˆéƒ¨ç½²æŒ‡å—
- `POST /tasks/conversations/{id}/text-to-speech` - æ–‡æœ¬è½¬è¯­éŸ³

## ğŸ§ª æµ‹è¯•

### åŸºæœ¬åŠŸèƒ½æµ‹è¯•
```bash
python test_client.py
```

### å¹¶å‘æµ‹è¯•
```bash
# æµ‹è¯•5ä¸ªå¹¶å‘ç”¨æˆ·
python concurrent_test.py load 5

# å‹åŠ›æµ‹è¯•
python concurrent_test.py stress
```

### å®Œæ•´æµ‹è¯•å¥—ä»¶
```bash
python quick_test.py
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥URL | `sqlite:///./pcb_tool.db` |
| `SECRET_KEY` | JWTç­¾åå¯†é’¥ | `your-secret-key-here` |
| `API_KEY_DIFY` | Dify APIå¯†é’¥ | - |
| `NVIDIA_API_KEY` | NVIDIA APIå¯†é’¥ | - |
| `UPLOAD_DIR` | æ–‡ä»¶ä¸Šä¼ ç›®å½• | `uploads` |
| `MAX_FILE_SIZE` | æœ€å¤§æ–‡ä»¶å¤§å° | `10485760` (10MB) |

### æ•°æ®åº“é…ç½®

é»˜è®¤ä½¿ç”¨SQLiteï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨PostgreSQLï¼š

```bash
# PostgreSQL
DATABASE_URL=postgresql://user:password@localhost/pcb_tool

# MySQL
DATABASE_URL=mysql://user:password@localhost/pcb_tool
```

## ğŸš€ éƒ¨ç½²

### Dockeréƒ¨ç½²

```bash
# å•æœåŠ¡éƒ¨ç½²
docker build -t pcb-tool-backend .
docker run -p 8000:8000 pcb-tool-backend

# å®Œæ•´æœåŠ¡æ ˆ
docker-compose up -d
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. ä½¿ç”¨PostgreSQLæ•°æ®åº“
2. é…ç½®Redisç¼“å­˜
3. ä½¿ç”¨Nginxåå‘ä»£ç†
4. å¯ç”¨HTTPS
5. é…ç½®æ—¥å¿—æ”¶é›†

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **å¹¶å‘ç”¨æˆ·**: æ”¯æŒ15+å¹¶å‘ç”¨æˆ·
- **å“åº”æ—¶é—´**: APIå¹³å‡å“åº”æ—¶é—´ < 200ms
- **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒæœ€å¤§10MBæ–‡ä»¶
- **å†…å­˜ä½¿ç”¨**: åŸºç¡€å†…å­˜å ç”¨ < 512MB
- **æ•°æ®åº“**: æ”¯æŒå¤§é‡ä¼šè¯å’Œç”¨æˆ·æ•°æ®

## ğŸ” ç›‘æ§å’Œæ—¥å¿—

### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:8000/health
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# Dockeræ—¥å¿—
docker-compose logs -f pcb-tool-backend

# æœ¬åœ°æ—¥å¿—
tail -f app.log
```

## ğŸ¤ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨`models/`ä¸­å®šä¹‰æ•°æ®æ¨¡å‹
2. åœ¨`schemas/`ä¸­å®šä¹‰Pydanticæ¨¡å¼
3. åœ¨`services/`ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
4. åœ¨`api/`ä¸­æ·»åŠ APIç«¯ç‚¹
5. æ›´æ–°æµ‹è¯•ç”¨ä¾‹

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ç±»å‹æç¤º
- æ·»åŠ æ–‡æ¡£å­—ç¬¦ä¸²
- éµå¾ªPEP 8è§„èŒƒ
- ç¼–å†™å•å…ƒæµ‹è¯•

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£å ç”¨**: ä¿®æ”¹`.env`ä¸­çš„ç«¯å£é…ç½®
2. **ä¾èµ–å®‰è£…å¤±è´¥**: ä½¿ç”¨Python 3.8+ç‰ˆæœ¬
3. **APIå¯†é’¥é”™è¯¯**: æ£€æŸ¥`.env`æ–‡ä»¶é…ç½®
4. **æ•°æ®åº“è¿æ¥å¤±è´¥**: ç¡®è®¤æ•°æ®åº“æœåŠ¡æ­£å¸¸è¿è¡Œ

### è·å–å¸®åŠ©

- æŸ¥çœ‹APIæ–‡æ¡£: http://localhost:8000/docs
- è¿è¡Œå¥åº·æ£€æŸ¥: `python quick_test.py`
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶: `app.log`

---

ğŸ‰ **ç°åœ¨æ‚¨çš„PCBå·¥å…·åç«¯æœåŠ¡å·²ç»å‡†å¤‡å°±ç»ªï¼äº«å—é«˜æ•ˆçš„ç”µè·¯è®¾è®¡å’Œåˆ†æä½“éªŒå§ï¼**
